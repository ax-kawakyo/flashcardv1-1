<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚ªãƒªã‚¸ãƒŠãƒ«å˜èªã‚«ãƒ¼ãƒ‰</title>
    <!-- å˜èªãƒªã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ -->

    <style>
        /* ã“ã“ã«å¾Œã§CSSï¼ˆãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ */
body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
            margin: 0;
        }

        #card-container {
            width: 90%;
            max-width: 400px;
            height: 250px;
            perspective: 1000px; /* ã‚«ãƒ¼ãƒ‰ãŒå›è»¢ã™ã‚‹ã¨ãã®å¥¥è¡Œãæ„Ÿ */
            margin-bottom: 20px;
        }

        #card {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer; /* ã‚«ãƒ¼ã‚½ãƒ«ã‚’ä¹—ã›ã‚‹ã¨æŒ‡ãƒãƒ¼ã‚¯ã«ãªã‚‹ */
        }

        /* ã‚«ãƒ¼ãƒ‰ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å›è»¢ã‚¯ãƒ©ã‚¹ï¼ˆå¾Œã§JavaScriptã§è¿½åŠ ã—ã¾ã™ï¼‰ */
        #card.is-flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden; /* è£é¢ã‚’éš ã™ãŠã¾ã˜ãªã„ */
            display: flex;
            justify-content: center;
            align-items: center;
            /* font-size: 2.5rem; */
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

/* --- ã‚«ãƒ¼ãƒ‰ã®è¡¨é¢ã¨è£é¢ã®å€‹åˆ¥è¨­å®š --- */
    
    #card-front {
        background-color: white;
        color: black;
        /* â†“â†“è‹±å˜èªã®æ–‡å­—ã‚µã‚¤ã‚ºã¯ã€ã“ã“ã§å¤‰æ›´ã—ã¦ãã ã•ã„â†“â†“ */
        font-size: 48px; /* 3.5rem ã®ä»£ã‚ã‚Šã« px ã§æŒ‡å®š */
    }

    #card-back {
        background-color: #4a90e2;
        color: white;
        transform: rotateY(180deg);
        /* â†“â†“æ—¥æœ¬èªè¨³ã®æ–‡å­—ã‚µã‚¤ã‚ºã¯ã€ã“ã“ã§å¤‰æ›´ã—ã¦ãã ã•ã„â†“â†“ */
        font-size: 24px; /* 2.5rem ã®ä»£ã‚ã‚Šã« px ã§æŒ‡å®š */
    }

        #button-container {
            text-align: center;
        }

        #next-button {
            padding: 10px 20px;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            background-color: #5cb85c; /* å°‘ã—è½ã¡ç€ã„ãŸç·‘è‰² */
            color: white;
            cursor: pointer;
        }
        #sub-button-container {
            margin-top: 15px;
        }

        #uncheck-button, #check-button {
            width: 120px;
            padding: 15px 0;
            font-size: 1rem;
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            margin: 0 10px;
        }

        #uncheck-button {
            background-color: #f0ad4e; /* ã‚ªãƒ¬ãƒ³ã‚¸ç³» */
        }

        #check-button {
            background-color: #5cb85c; /* ç·‘ç³» */
        }

        #reset-button, #review-button {
            padding: 8px 15px;
            font-size: 0.9rem;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
            color: #333;
            cursor: pointer;
            margin: 0 5px;
        }

        #back-link-container {
            margin-top: 20px;
        }
        #back-link-container a {
            text-decoration: none;
            color: #4a90e2;
        }
    </style>
</head>
<body>

    <div id="card-container">
        <div id="card">
            <div id="card-front">
                <!-- ã“ã“ã«è‹±å˜èªãŒè¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
            <div id="card-back">
                <!-- ã“ã“ã«æ—¥æœ¬èªè¨³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

<div id="button-container">
        <button id="uncheck-button">ğŸ¤” ã‚‚ã†ä¸€å›ï¼</button>
        <button id="check-button">ğŸ‘ ã‚«ãƒ³ãƒšã‚­ï¼</button>
    </div>
    <div id="sub-button-container">
        <button id="reset-button">ãƒªã‚»ãƒƒãƒˆã—ã¦å…¨éƒ¨å¾©ç¿’</button>
        <button id="review-button">ã€Œã‚‚ã†ä¸€å›ï¼ã€ã ã‘å¾©ç¿’</button>
    </div>

    <!-- â˜…â˜…â˜… ã“ã®éƒ¨åˆ†ã‚’è¿½åŠ  â˜…â˜…â˜… -->
    <div id="back-link-container">
        <a href="index.html">Â« ãƒªã‚¹ãƒˆé¸æŠã«ã‚‚ã©ã‚‹</a>
    </div>

<script>
        // --- URLã‹ã‚‰ã€ã©ã®ãƒªã‚¹ãƒˆã‚’ä½¿ã†ã‹æƒ…å ±ã‚’å–å¾— ---
        const params = new URLSearchParams(window.location.search);
        const listId = params.get('list') || 'chu1'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ 'chu1'

        // CSVãƒ†ã‚­ã‚¹ãƒˆã‚’è§£æã™ã‚‹å°‚é–€ã®é–¢æ•°
        function parseCSV(text) {
            const lines = text.trim().split('\n');
            if (lines.length < 2) return []; // ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã¿ã€ã¾ãŸã¯ç©ºã®å ´åˆã¯ç©ºã®é…åˆ—ã‚’è¿”ã™

            const headers = lines[0].split(',').map(h => h.trim());
            const data = [];
            for (let i = 1; i < lines.length; i++) {
                // ç©ºè¡Œã¯ã‚¹ã‚­ãƒƒãƒ—
                if (lines[i].trim() === '') continue;

                const values = lines[i].split(',');
                const entry = {};
                for (let j = 0; j < headers.length; j++) {
                    entry[headers[j]] = values[j] ? values[j].trim() : '';
                }
                data.push(entry);
            }
            return data;
        }

        // ã‚¢ãƒ—ãƒªã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®šã‚’è¡Œã†é–¢æ•°
        function setupApp(wordData) {
            // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
            const allWords = wordData.map(word => ({ ...word, status: 'unseen' }));
            
            let currentWords = [...allWords];
            let currentWordIndex = 0;

            // --- HTMLè¦ç´ ã®å–å¾— ---
            const card = document.getElementById('card');
            const cardFront = document.getElementById('card-front');
            const cardBack = document.getElementById('card-back');
            const checkButton = document.getElementById('check-button');
            const uncheckButton = document.getElementById('uncheck-button');
            const resetButton = document.getElementById('reset-button');
            const reviewButton = document.getElementById('review-button');

            // --- æ©Ÿèƒ½ã®å®Ÿè£… ---
            function showWord() {
                if (currentWords.length === 0) {
                    cardFront.textContent = 'ğŸ‰';
                    cardBack.textContent = 'å®Œäº†ï¼';
                    return;
                }
                cardFront.textContent = currentWords[currentWordIndex].english;
                cardBack.textContent = currentWords[currentWordIndex].japanese;
            }

            function goToNextWord() {
                if (card.classList.contains('is-flipped')) {
                    card.classList.remove('is-flipped');
                }
                
                setTimeout(() => {
                    if (currentWords.length > 0) {
                        currentWords.splice(currentWordIndex, 1);
                    }
                    if (currentWords.length === 0) {
                        showWord();
                        return;
                    }
                    currentWordIndex = 0;
                    showWord();
                }, 300);
            }
            
            card.addEventListener('click', () => {
                if (currentWords.length > 0) {
                    card.classList.toggle('is-flipped');
                }
            });
            
            checkButton.addEventListener('click', () => {
                if (currentWords.length === 0) return;
                const word = currentWords[currentWordIndex];
                const originalWord = allWords.find(w => w.english === word.english);
                if(originalWord) originalWord.status = 'checked';
                goToNextWord();
            });
            
            uncheckButton.addEventListener('click', () => {
                if (currentWords.length === 0) return;
                const word = currentWords[currentWordIndex];
                const originalWord = allWords.find(w => w.english === word.english);
                if(originalWord) originalWord.status = 'unchecked';
                goToNextWord();
            });

            resetButton.addEventListener('click', () => {
                allWords.forEach(word => word.status = 'unseen');
                currentWords = [...allWords];
                currentWordIndex = 0;
                showWord();
            });

            reviewButton.addEventListener('click', () => {
                const uncheckedWords = allWords.filter(word => word.status === 'unchecked');
                if(uncheckedWords.length === 0) {
                    alert('ã€Œã‚‚ã†ä¸€å›ï¼ã€ã®ã‚«ãƒ¼ãƒ‰ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç´ æ™´ã‚‰ã—ã„ï¼');
                    return;
                }
                currentWords = [...uncheckedWords];
                currentWordIndex = 0;
                showWord();
            });

            // --- åˆæœŸåŒ–å‡¦ç† ---
            showWord();
        }

        // --- ã‚¢ãƒ—ãƒªã®å®Ÿè¡Œé–‹å§‹ ---
        async function run() {
            try {
                const response = await fetch(`words_${listId}.csv`);
                if (!response.ok) {
                    throw new Error(`CSVãƒ•ã‚¡ã‚¤ãƒ« (words_${listId}.csv) ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚`);
                }
                const csvText = await response.text();
                const wordData = parseCSV(csvText);
                setupApp(wordData);
            } catch (error) {
                console.error('ã‚¨ãƒ©ãƒ¼:', error);
                alert('å˜èªãƒªã‚¹ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n' + error.message);
            }
        }

        run();
    </script>
</body>
</html>




